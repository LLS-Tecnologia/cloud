#!/bin/bash
# Biblioteca para os Scripts de Configuração do Cloud
#
# Autor: Leandro Luiz
# email: lls.homeoffice@gmail.com

lib_update()
{
	
	if [ ! -d /${DIR_CONF} ]; then
	
		mkdir -pv /${DIR_CONF}
	
	fi
	
	cp -fv ${DIR_CONF}/${FILE_CONF} /${DIR_CONF}/${FILE_CONF}
	
	ARQ_EXT="${FILE_CONF##*.}"
	
	echo "Arquivo: ${ARQ_EXT}"
	
	if [ "${ARQ_EXT}" != "pfx" -a "${ARQ_EXT}" != "ico" -a "${ARQ_EXT}" != "png" ]; then
	
		cat /${DIR_CONF}/${FILE_CONF}
		
	fi
	
}

if [ "$EUID" -ne 0 ]; then
	echo "Rodar script como root"
	exit 1
  
fi

USER=`git config user.name`

if [ -z "${USER}" ]; then
		
	echo "Not found a user name!"
	echo "Use: git_conf.sh name {NAME}"
	exit 1
	
fi

EMAIL=`git config user.email`

if [ -z "${EMAIL}" ]; then
		
	echo "Not found a user email!"
	echo "Use: git_conf.sh email {EMAIL}"
	exit 1
	
fi

PASSWORD=`git config user.password`

if [ -z "${PASSWORD}" ]; then
	
	echo "Not found a user password!"
	echo "Use: git_conf.sh password {PASSWORD}"
	exit 1
	
fi

DIR_TOMCAT="/usr/share/tomcat"
DIR_TOMCAT_CONF="${DIR_TOMCAT}/conf"
DIR_WEBAPPS="${DIR_TOMCAT}/webapps"
DIR_LLS="${DIR_WEBAPPS}/${USER}"
DIR_KEYSTORE="${DIR_LLS}/keystore"

DNAME="${USER}.net.br"

HOSTNAME="`hostname`"

if [ "${HOSTNAME}" != "${USER}" ]; then

	DNAME="${HOSTNAME}.${DNAME}"

fi

DOMAIN=$(echo "${DNAME}" | sed s/[.]/_/g)

KEYSTORE="${DIR_KEYSTORE}/${DOMAIN}.pfx"
ALIAS="${USER}Key"
